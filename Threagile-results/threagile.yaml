threagile_version: 1.0.0

title: E-Commerce Platform

date: 2025-01-06

author:
  name: Kshitija Kulkarni
  homepage: www.example.com




management_summary_comment: >
  an e-commerce platform that allows customers to browse products, add items to their cart, place orders, and process payments.

business_criticality: critical # values: archive, operational, important, critical, mission-critical




business_overview:
  description: an e-commerce platform that allows customers to browse products, add items to their cart, place orders, and process payments.
  images:
#    - custom-image-1.png: Some dummy image 1
#    - custom-image-2.png: Some dummy image 2


technical_overview:
  description: The platform uses a distributed, clustered infrastructure for high availability, scalability, and fault tolerance. It also includes multiple microservices like user management, inventory management, order processing, and payment gateways.
  images:
#    - custom-image-1.png: Some dummy image 1
#    - custom-image-2.png: Some dummy image 2

questions: # simply use "" as answer to signal "unanswered"
  How are the admin clients managed/protected against compromise?: ""
  How are the development clients managed/protected against compromise?: >
    Managed by XYZ
  How are the build pipeline components managed/protected against compromise?: >
    Managed by XYZ



abuse_cases:
  Denial-of-Service: >
    As a hacker I want to disturb the functionality of the backend system in order to cause indirect
    financial damage via unusable features.
  CPU-Cycle Theft: >
    As a hacker I want to steal CPU cycles in order to transform them into money via installed crypto currency miners.
  Ransomware: >
    As a hacker I want to encrypt the storage and file systems in order to demand ransom.
  Identity Theft: >
    As a hacker I want to steal identity data in order to reuse credentials and/or keys on other targets of the same company or outside.
  PCI Theft: >
    As a hacker I want to steal PII (Personally Identifiable Information) data in order to blackmail the company and/or damage
    their repudiation by publishing them.


  Database Compromise: >
    Attackers exploiting SQL injection vulnerabilities to extract sensitive information.
  Cross-Site Scripting Attacks: >
    Malicious scripts injected into user input fields (e.g., search, reviews) to steal session cookies.
  Denial-of-Service of Enduser Functionality: >
    Attackers overwhelming the web servers, API Gateway, or backend services with excessive traffic.
  Session Hijacking : >
    Attackers stealing or hijacking valid session cookies to impersonate users.
  Privilege Escalation : >
    Attackers exploiting misconfigurations or vulnerabilities to gain elevated privileges on backend services or databases.



security_requirements:
  Input Validation: Strict input validation is required to reduce the overall attack surface.
  Data encryption: Custumer PCI data should be encrypted using strong encryption in transit ans rest.

tags_available:
  - linux
  - apache
  - mysql
  - aws
  - aws:ec2
  - aws:s3
  - aws:rds
  - aws:ecr

data_assets:

  User Data: &user-data # this example shows the inheritance-like features of YAML
    id: user-data
    description: Personal information (name, email, address), credit card details, purchase history.
    usage: business # values: business, devops
    tags:
    origin: User
    owner: Company XYZ
    quantity: many # values: very-few, few, many, very-many
    confidentiality: confidential # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      User data might contain financial data as well as personally identifiable information (PII). The confidentiality, integrity and
      availability of user data is required for User data privacy and platform functionality.

  Payment data:
    <<: *user-data # here we're referencing the above created asset as base and just overwrite few values
    id: payment-data
    description: Payment transaction details and communication with third-party payment processors.
    confidentiality: strictly-confidential # values: public, internal, restricted, confidential, strictly-confidential
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Payment data might contain financial data as well as personally identifiable information (PII). The confidentiality, integrity and
      availability of payment data is required for preventing financial fraud and identity theft.

  Product Data: &product-data
    id: product-data
    description: Product names, descriptions, prices, and inventory counts.
    usage: business # values: business, devops
    tags:
    origin: User
    owner: Company XYZ
    quantity: many # values: very-few, few, many, very-many
    confidentiality: public # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The integrity and availability of product data is required for platform functionality.

  Order Data: &order-data
    id: order-data
    description: Details of user orders, order statuses, shipping information.
    usage: business # values: business, devops
    tags:
    origin: User
    owner: Company XYZ
    quantity: many # values: very-few, few, many, very-many
    confidentiality: restricted # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Order data may contain PCI and user location data. The confidentiality, integrity and availability of order data is required for platform functionality.

  Session Data: &session-data
    <<: *user-data
    id: session-data
    description: User sessions and authentication tokens.
    usage: devops # values: business, devops
    tags:
    origin: Company XYZ
    owner: Company XYZ
    quantity: many # values: very-few, few, many, very-many
    confidentiality: strictly-confidential # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Payment data might contain financial data as well as personally identifiable information (PII). The confidentiality, integrity and
      availability of payment data is required for preventing financial fraud and identity theft.

  Database Customizing and Dumps:
    id: db-dumps
    description: Data for customizing of the DB system, which might include full database dumps.
    usage: devops # values: business, devops
    tags:
      - aws:rds
    origin: Company XYZ
    owner: Company XYZ
    quantity: very-few # values: very-few, few, many, very-many
    confidentiality: strictly-confidential # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Data for customizing of the DB system, which might include full database dumps.

technical_assets:

  Web Client:
    id: web-client
    description: Customer Web Client
    type: external-entity # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: true
    out_of_scope: true
    justification_out_of_scope: Owned and managed by enduser customer
    size: component # values: system, service, application, component
    technology: browser # values: see help
    tags:
    internet: true
    machine: physical # values: physical, virtual, container, serverless
    encryption: none # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Customer
    confidentiality: public # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The client used by the customers to access the E-commerse platform.
    multi_tenant: false
    redundant: false
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - payment-data
      - product-data
      - order-data
      - session-data
    data_assets_stored:
      - session-data # sequence of IDs to reference
    data_formats_accepted: # sequence of formats like: json, xml, serialization, file, csv
    communication_links:
      API gateway Traffic:
        target: api-gateway
        description: Link to the API gateway
        protocol: https # values: see help
        authentication: session-id # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: enduser-identity-propagation # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: false
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - payment-data
          - product-data
          - order-data
          - session-data
        data_assets_received: # sequence of IDs to reference
          - user-data
          - payment-data
          - product-data
          - order-data
          - session-data

  API gateway:
    id: api-gateway
    description: API gateway
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: component # values: system, service, application, component
    technology: gateway # values: see help
    tags:
    internet: true
    machine: virtual # values: physical, virtual, container, serverless
    encryption: data-with-asymmetric-shared-key # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality: public # values: public, internal, restricted, confidential, strictly-confidential
    integrity: critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      API gateway connects to client
    multi_tenant: false
    redundant: false
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - payment-data
      - product-data
      - order-data
      - session-data
    data_assets_stored: # sequence of IDs to reference
    data_formats_accepted:
      - json # sequence of formats like: json, xml, serialization, file, csv
    communication_links:
      Customer Traffic:
        target: load-balancer
        description: Link to the load balancer
        protocol: https # values: see help
        authentication: session-id # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: enduser-identity-propagation # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: false
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - payment-data
          - product-data
          - order-data
          - session-data
        data_assets_received: # sequence of IDs to reference
          - user-data
          - payment-data
          - product-data
          - order-data
          - session-data


  Load Balancer:
    id: load-balancer
    #diagram_tweak_order: 50 # affects left to right positioning (only within a trust boundary)
    description: Load Balancer
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: component # values: system, service, application, component
    technology: load-balancer # values: see help
    tags:
    internet: false
    machine: virtual # values: physical, virtual, container, serverless
    encryption: data-with-asymmetric-shared-key # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality: internal # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The correct configuration and reachability of the load balancer is mandatory for all customer and Company XYZ
      usages of the Platform.
    multi_tenant: false
    redundant: true
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - payment-data
      - product-data
      - order-data
      - session-data
    data_assets_stored: # sequence of IDs to reference
    data_formats_accepted: # sequence of formats like: json, xml, serialization, file, csv
    communication_links:
      User Service Traffic:
        target: user-service
        description: Link to the service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
        data_assets_received: # sequence of IDs to reference
          - user-data
          - session-data
      Order Service Traffic:
        target: order-service
        description: Link to the orders service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
         - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
         - user-data
         - product-data
         - order-data
         - session-data
        data_assets_received: # sequence of IDs to reference
         - user-data
         - product-data
         - order-data
         - session-data
      Inventory Service Traffic:
        target: inventory-service
        description: Link to the  Inventory service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
        - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        - user-data
        - product-data
        - session-data
        data_assets_received: # sequence of IDs to reference
        - user-data
        - product-data
        - session-data


  User Service:
    id: user-service
    description: Manages user authentication, profile, and session management.
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: service # values: system, service, application, component
    technology: container-platform # values: see help
    tags:
      - linux
      - aws:ec2
    internet: false
    machine: container # values: physical, virtual, container, serverless
    encryption: none # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality:  restricted # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The correct configuration and reachability of the service is mandatory for all customer usages of the Platform.
    multi_tenant: true
    redundant: true
    custom_developed_parts: true
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - session-data
    data_assets_stored: # sequence of IDs to reference
      - user-data
      - session-data
    data_formats_accepted: # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      User Traffic:
        target: load-balancer
        description: Link to the load balancer
        protocol: https # values: see help
        authentication: session-id # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: enduser-identity-propagation # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: false
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - session-data
        data_assets_received: # sequence of IDs to reference
          - user-data
      Payment Service Traffic:
        target: payment-service
        description: Link to the payment service inside cluster
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - user-data
          - payment-data
      Messaging Queue:
        target: message-queue
        description: Link
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: false
        readonly: true
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - user-data
          - payment-data

  Order Service:
    id: order-service
    description: Manages order creation, status, and tracking.
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: service # values: system, service, application, component
    technology: container-platform # values: see help
    tags:
      - linux
      - aws:ec2
    internet: false
    machine: container # values: physical, virtual, container, serverless
    encryption: none # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality:  restricted # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The correct configuration and reachability of the service is mandatory for all customer usages of the Platform.
    multi_tenant: true
    redundant: true
    custom_developed_parts: true
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - order-data
      - session-data
    data_assets_stored: # sequence of IDs to reference
      - user-data
      - order-data
      - session-data
    data_formats_accepted: # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      Order Traffic:
        target: load-balancer
        description: Link to the load balancer
        protocol: https # values: see help
        authentication: session-id # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: enduser-identity-propagation # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: false
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - order-data
        data_assets_received: # sequence of IDs to reference
          - user-data
          - order-data
          - session-data
      Payment Service Traffic:
        target: payment-service
        description: Link to the payment service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - user-data
          - order-data
          - payment-data
      Messaging Queue:
        target: message-queue
        description: Link
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: false
        readonly: true
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - order-data

  Inventory Service:
    id: inventory-service
    description: Handles product catalog, stock levels, and pricing.
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: service # values: system, service, application, component
    technology: container-platform # values: see help
    tags:
      - linux
      - aws:ec2
    internet: false
    machine: container # values: physical, virtual, container, serverless
    encryption: none # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality:  internal # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The correct configuration and reachability of the service is mandatory for all customer usages of the Platform.
    multi_tenant: true
    redundant: true
    custom_developed_parts: true
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - order-data
      - product-data
      - session-data
    data_assets_stored: # sequence of IDs to reference
      - user-data
      - order-data
      - product-data
    data_formats_accepted:  # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      Inventory Traffic:
        target: load-balancer
        description: Link to the load balancer
        protocol: https # values: see help
        authentication: session-id # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: enduser-identity-propagation # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: false
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - order-data
          - session-data
          - product-data
        data_assets_received: # sequence of IDs to reference
          - product-data
          - order-data
          - session-data
      Payment Service Traffic:
        target: payment-service
        description: Link to the payment service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - order-data
          - payment-data
          - product-data
      Messaging Queue:
        target: message-queue
        description: Link
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: false
        readonly: true
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - product-data

  Payment Service:
    id: payment-service
    description: Integrates with external payment gateways (e.g., Stripe, PayPal) for payment processing.
    type: process # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: service # values: system, service, application, component
    technology: container-platform # values: see help
    tags:
      - linux
      - aws:ec2
    internet: true
    machine: container # values: physical, virtual, container, serverless
    encryption: data-with-asymmetric-shared-key # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality: restricted # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Payment gateway integration service
    multi_tenant: false
    redundant: false
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - payment-data
      - user-data
      - order-data
      - product-data
    data_assets_stored: # sequence of IDs to reference
    data_formats_accepted:  # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      Database communication:
        target: sql-database
        description: Link to the database
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: true
        readonly: false
        usage: devops # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - order-data
          - product-data
          - payment-data
        data_assets_received: # sequence of IDs to reference
          - user-data
          - order-data
          - product-data
          - session-data
          - payment-data
          #diagram_tweak_weight: 1
          #diagram_tweak_constraint: false
      Messaging Queue:
        target: message-queue
        description: Link
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: false
        readonly: true
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - payment-data

  Messaging Queue:
    id: message-queue
    description: Used for communication between microservices
    type: process # values: external-entity, process, datastore
    usage: devops # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: service # values: system, service, application, component
    technology: message-queue # values: see help
    tags:
      - linux
      - aws:ec2
    internet: true
    machine: container # values: physical, virtual, container, serverless
    encryption: data-with-symmetric-shared-key # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality: internal # values: public, internal, restricted, confidential, strictly-confidential
    integrity: operational # values: archive, operational, important, critical, mission-critical
    availability: operational # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      Internal
    multi_tenant: false
    redundant: false
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - payment-data
      - user-data
      - order-data
      - product-data
    data_assets_stored: # sequence of IDs to reference
    data_formats_accepted: # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      Database communication:
        target: sql-database
        description: Link to the database (JDBC tunneled via SSH)
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
        vpn: false
        ip_filtered: true
        readonly: false
        usage: devops # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - user-data
          - order-data
          - product-data
          - payment-data
        data_assets_received:
         # sequence of IDs to reference
      Payment Service Traffic:
        target: payment-service
        description: Link to the payment service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - payment-data
      Inventory Service Traffic:
        target: inventory-service
        description: Link to the Inventory service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: devops # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - product-data
      Order Service Traffic:
        target: order-service
        description: Link to the Order service inside cluster
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: devops # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - order-data
      User Service Traffic:
        target: user-service
        description: Link to the User service inside cluster
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: devops # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - user-data

  Database cluster:
    id: sql-database
    description: The database
    type: datastore # values: external-entity, process, datastore
    usage: business # values: business, devops
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope:
    size: component # values: system, service, application, component
    technology: database # values: see help
    tags:
      - linux
      - mysql
      - aws:rds
    internet: false
    machine: virtual # values: physical, virtual, container, serverless
    encryption: data-with-symmetric-shared-key # values: none, transparent, data-with-symmetric-shared-key, data-with-asymmetric-shared-key, data-with-enduser-individual-key
    owner: Company XYZ
    confidentiality: strictly-confidential # values: public, internal, restricted, confidential, strictly-confidential
    integrity: mission-critical # values: archive, operational, important, critical, mission-critical
    availability: mission-critical # values: archive, operational, important, critical, mission-critical
    justification_cia_rating: >
      The database contains business-relevant sensitive data for Company XYZ processes.
    multi_tenant: false
    redundant: false
    custom_developed_parts: false
    data_assets_processed: # sequence of IDs to reference
      - user-data
      - order-data
      - product-data
      - payment-data
    data_assets_stored: # sequence of IDs to reference
      - user-data
      - order-data
      - product-data
      - payment-data
    data_formats_accepted:  # sequence of formats like: json, xml, serialization, file, csv
      - json
    communication_links:
      Payment Service Traffic:
        target: payment-service
        description: Link to the payment service inside cluster
        protocol: https # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: true
        readonly: false
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
          - payment-data
        data_assets_received: # sequence of IDs to reference
          - payment-data
      Messaging Queue:
        target: message-queue
        description: Link
        protocol: http # values: see help
        authentication: token # values: none, credentials, session-id, token, client-certificate, two-factor
        authorization: technical-user # values: none, technical-user, enduser-identity-propagation
        tags:
          - aws:ec2
        vpn: false
        ip_filtered: false
        readonly: true
        usage: business # values: business, devops
        data_assets_sent: # sequence of IDs to reference
        data_assets_received: # sequence of IDs to reference
          - user-data
          - order-data
          - product-data
          - payment-data

trust_boundaries:

  Cluster Group:
    id: cluster-group
    description: Cluster Security group
    type: network-cloud-security-group # values: see help
    tags:
    technical_assets_inside: # sequence of IDs to reference
      - load-balancer
      - user-service
      - order-service
      - inventory-service
      - payment-service
      - message-queue
      - sql-database
    trust_boundaries_nested:

  Application Network:
    id: application-network
    description: Application Network
    type: network-cloud-provider # values: see help
    tags:
      - aws
    technical_assets_inside: # sequence of IDs to reference
      - api-gateway
    trust_boundaries_nested: # sequence of IDs to reference
      - cluster-group

risk_tracking:

  missing-authentication-second-factor@*@*@*: # wildcards "*" between the @ characters are possible
    status: mitigated # values: unchecked, in-discussion, accepted, in-progress, mitigated, false-positive
    justification: The hardening measures were implemented and checked
    ticket: XYZ-1234
    date: 2025-01-04
    checked_by: John Doe

  dos-risky-access-across-trust-boundary@*@*@*: # wildcards "*" between the @ characters are possible
    status: mitigated # values: unchecked, in-discussion, accepted, in-progress, mitigated, false-positive
    justification: The hardening measures are being implemented and checked. Used AWS DOS mitigation
    ticket: XYZ-1234
    date: 2025-01-04
    checked_by: John Doe
